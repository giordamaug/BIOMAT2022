# BIOMAT2022
This repo is the experimental workbench for paper

```
Network-Based Computational Modeling to Unravel
Gene Essentiality. I. GRANATA et al.
To appear in BIOMAT2022
```

# How to reproduce experiments

Just open the `BIOMAT2022_workbench.ipynb` notebook and click on the Google Colab launch button.

# Experimental Study

## Gene labeling

By using the label `label_CS_ACH_most_freq`, we consdered Essential the
genes having  `label_CS_ACH_most_freq==CS0`, and Non Essential the genes with `label_CS_ACH_most_freq` in `[CS6, ..., CS9]`.


Thus, not all genes will be labeled. Of 12538 total genes, 3814 are labelled.

Gene biological (BIO and GTEX) attributes are normalized by Z-score.
Gene topological attributes are computed by karateclub node embedding methods.
Embedding dimension is 128. Embedding are computed on the entire network (PPI, MET or integrated). Once the embedding vector si produced for each genes, only those corresponding to labelled genes are selected for training of the classifier method.

Reported metrics are related to a stratified 5-fold cross validation on the set of labelled genes.

# Results

## PPI network

#### BIO+GTEX

|      |  Accuracy  |       BA |   Sensitivity |   Specificity |      MCC | CM            |
| ---- | ---------- | -------- | ------------- | ------------- | -------- | ------------- |
| LGBM |   0.904825 | 0.819903 |      0.680537 |      0.959269 | 0.68234  | [[ 507  238]  |
|      |            |          |               |               |          |  [ 125 2944]] |
| XGB  |   0.895646 | 0.806577 |      0.660403 |      0.952751 | 0.651845 | [[ 492  253]  |
|      |            |          |               |               |          |  [ 145 2924]] |
| MLP  |   0.855275 | 0.690011 |      0.418792 |      0.961229 | 0.475601 | [[ 312  433]  |
|      |            |          |               |               |          |  [ 119 2950]] |
| RF   |   0.879919 | 0.727178 |       0.47651 |      0.977846 | 0.574159 | [[ 355  390]  |
|      |            |          |               |               |          |  [  68 3001]] |

#### BIO+GTEX+Node2Vec

|      |  Accuracy  |       BA |   Sensitivity |   Specificity |      MCC | CM            |
| ---- | ---------- | -------- | ------------- | ------------- | -------- | ------------- |
| LGBM |   0.927635 | 0.849832 |      0.722148 |      0.977516 | **0.758463** | [[ 538  207]  |
|      |            |          |               |               |          |  [  69 3000]] |
| XGB |   0.922654 | 0.842672 |      0.711409 |      0.973935 | 0.741349 | [[ 530  215]  |
|     |            |          |               |               |          |  [  80 2989]] |
| MLP |   0.918984 | **0.856145** |       0.75302 |       0.95927 | 0.735039 | [[ 561  184]  |
|     |            |          |               |               |          |  [ 125 2944]] |
| RF |   0.899582 | 0.762774 |      0.538255 |      0.987293 | 0.652522 | [[ 401  344]  |
|    |            |          |               |               |          |  [  39 3030]] |

#### BIO+GTEX+DeepWalk

|      |  Accuracy  |       BA |   Sensitivity |   Specificity |      MCC | CM            |
| ---- | ---------- | -------- | ------------- | ------------- | -------- | ------------- |
| LGBM |    0.92554 | 0.83989 |      0.699329 |      0.980452 | **0.749946** | [[ 521  224]  |
|      |            |         |               |               |          |  [  60 3009]] |
| XGB |   0.923177 | 0.839947 |      0.703356 |      0.976538 | 0.742353 | [[ 524  221]  |
|     |            |          |               |               |          |  [  72 2997]] |
| MLP |   0.917932 | **0.851427** |      0.742282 |      0.960571 | 0.730933 | [[ 553  192]  |
|     |            |          |               |               |          |  [ 121 2948]] |
| RF |   0.896962 | 0.755046 |      0.522148 |      0.987944 | 0.641838 | [[ 389  356]  |
|    |            |          |               |               |          |  [  37 3032]] |

#### BIO+GTEX+HOPE

|      |  Accuracy  |       BA |   Sensitivity |   Specificity |      MCC | CM            |
| ---- | ---------- | -------- | ------------- | ------------- | -------- | ------------- |
| LGBM |   0.905873 | 0.819539 |      0.677852 |      0.961227 | 0.685103 | [[ 505  240]  |
|      |            |          |               |               |          |  [ 119 2950]] |
| XGB |   0.904826 | 0.81838 |       0.67651 |       0.96025 | 0.68186 | [[ 504  241]  |
|     |            |         |               |               |         |  [ 122 2947]] |
| MLP |   0.850291 | 0.740279 |      0.559732 |      0.920827 | 0.504984 | [[ 417  328]  |
|     |            |          |               |               |          |  [ 243 2826]] |
| RF |   0.869166 | 0.721006 |      0.477852 |       0.96416 | 0.535904 | [[ 356  389]  |
|    |            |          |               |               |          |  [ 110 2959]] |

## MET network

#### BIO+GTEX

|     |   Accuracy |       BA |   Sensitivity |   Specificity |    MCC | CM            |
| ---- | ---------- | -------- | ------------- | ------------- | -------- | ------------- |
| LGBM |   0.904825 | 0.819903 |      0.680537 |      0.959269 | 0.68234 | [[ 507  238]  |
|      |            |          |               |               |         |  [ 125 2944]] |
| XGB |   0.898268 | 0.813797 |      0.675168 |      0.952425 | 0.662255 | [[ 503  242]  |
|     |            |          |               |               |          |  [ 146 2923]] |
| MLP |   0.851865 | 0.682809 |      0.405369 |      0.960249 | 0.459727 | [[ 302  443]  |
|     |            |          |               |               |          |  [ 122 2947]] |

#### BIO+GTEX+Node2Vec

|     |   Accuracy |       BA |   Sensitivity |   Specificity |      MCC | CM            |
| ---- | ---------- | -------- | ------------- | ------------- | -------- | ------------- |
| LGBM |    0.88752 | 0.778658 |           0.6 |      0.957316 | 0.616504 | [[ 447  298]  |
|      |            |          |               |               |          |  [ 131 2938]] |
| XGB |   0.888308 | 0.780163 |      0.602685 |      0.957642 | 0.619234 | [[ 449  296]  |
|     |            |          |               |               |          |  [ 130 2939]] |
| MLP |   0.812011 | 0.656522 |      0.401342 |      0.911701 | 0.348635 | [[ 299  446]  |
|     |            |          |               |               |          |  [ 271 2798]] |

#### BIO+GTEX+DeepWalk
|     |   Accuracy |       BA |   Sensitivity |   Specificity |      MCC | CM            |
| ---- | ---------- | -------- | ------------- | ------------- | -------- | ------------- |
| LGBM |   0.887782 | 0.77882 |           0.6 |       0.95764 | 0.616964 | [[ 447  298]  |
|      |            |         |               |               |          |  [ 130 2939]] |
| XGB |   0.886733 | 0.776644 |      0.595973 |      0.957315 | 0.613232 | [[ 444  301]  |
|     |            |          |               |               |          |  [ 131 2938]] |
| MLP |   0.817516 | 0.665533 |      0.416107 |      0.914958 | 0.36788 | [[ 310  435]  |
|     |            |          |               |               |         |  [ 261 2808]] |

#### BIO+GTEX+HOPE
|     |   Accuracy |       BA |   Sensitivity |   Specificity |      MCC | CM            |
| ---- | ---------- | -------- | ------------- | ------------- | -------- | ------------- |
| LGBM |   0.905081 | 0.820573 |      0.681879 |      0.959266 | 0.68309 | [[ 508  237]  |
|      |            |          |               |               |         |  [ 125 2944]] |
| XGB |    0.89643 | 0.810114 |      0.668456 |      0.951771 | 0.656043 | [[ 498  247]  |
|     |            |          |               |               |          |  [ 148 2921]] |
| MLP |   0.821444 | 0.629857 |      0.315436 |      0.944277 | 0.335774 | [[ 235  510]  |
|     |            |          |               |               |          |  [ 171 2898]] |

## MET+PPI network

#### BIO+GTEX

|     |   Accuracy |       BA |   Sensitivity |   Specificity |      MCC | CM            |
| ---- | ---------- | -------- | ------------- | ------------- | -------- | ------------- |
| LGBM |   0.904825 | 0.819903 |      0.680537 |      0.959269 | 0.68234 | [[ 507  238]  |
|      |            |          |               |               |         |  [ 125 2944]] |
| XGB |   0.898531 | 0.809385 |      0.663087 |      0.955682 | 0.660859 | [[ 494  251]  |
|     |            |          |               |               |          |  [ 136 2933]] |
| MLP |    0.85606 | 0.68999 |       0.41745 |      0.962531 | 0.477454 | [[ 311  434]  |
|     |            |         |               |               |          |  [ 115 2954]] |

#### BIO+GTEX+Node2Vec

|     |   Accuracy |       BA |   Sensitivity |   Specificity |      MCC | CM            |
| ---- | ---------- | -------- | ------------- | ------------- | -------- | ------------- |
| LGBM |   0.925012 | 0.847187 |      0.719463 |      0.974911 | 0.749644 | [[ 536  209]  |
|      |            |          |               |               |          |  [  77 2992]] |
| XGB |   0.923966 | 0.849077 |      0.726174 |       0.97198 | **0.746896** | [[ 541  204]  |
|     |            |          |               |               |          |  [  86 2983]] |
| MLP |   0.912691 | 0.844103 |      0.731544 |      0.956662 | 0.713719 | [[ 545  200]  |
|     |            |          |               |               |          |  [ 133 2936]] |

#### BIO+GTEX+DeepWalk
|     |   Accuracy |       BA |   Sensitivity |   Specificity |     MCC | CM            |
| ---- | ---------- | -------- | ------------- | ------------- | -------- | ------------- |
| LGBM |     0.9237 | 0.84129 |       0.70604 |       0.97654 | **0.744371** | [[ 526  219]  |
|      |            |         |               |               |          |  [  72 2997]] |
| XGB |   0.921606 | 0.842528 |      0.712752 |      0.972305 | 0.73816 | [[ 531  214]  |
|     |            |          |               |               |         |  [  85 2984]] |
| MLP |   0.918719 | 0.855981 |       0.75302 |      0.958942 | 0.735141 | [[ 561  184]  |
|     |            |          |               |               |          |  [ 126 2943]] |

#### BIO+GTEX+HOPE
|     |   Accuracy |       BA |   Sensitivity |   Specificity |      MCC | CM            |
| ---- | ---------- | -------- | ------------- | ------------- | -------- | ------------- |
| LGBM |   0.899578 | 0.811562 |      0.667114 |       0.95601 | 0.664508 | [[ 497  248]  |
|      |            |          |               |               |          |  [ 135 2934]] |
| XGB |   0.901151 | 0.813047 |      0.668456 |      0.957638 | 0.669963 | [[ 498  247]  |
|     |            |          |               |               |          |  [ 130 2939]] |
| MLP |   0.806504 | 0.688677 |      0.495302 |      0.882053 | 0.38051 | [[ 369  376]  |
|     |            |          |               |               |         |  [ 362 2707]] |
